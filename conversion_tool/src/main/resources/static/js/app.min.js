$(document).ready(function(){function n(){$(a).prop("disabled",!0)}function o(){$(a).prop("disabled",!1)}function p(){var a=$("#main-inner").innerHeight(),d=a/2-50;$(b).css({height:a+"px"}),$(c).css({"margin-top":d+"px"}),$(b).show()}function q(){$(b).hide()}function r(){$.get(l,function(a){var b=a;$.each(b.split("|"),function(a,b){$("#income_folder").append("<tr><td>"+b+"</td></tr>")})})}function t(){$("#income_folder").empty()}function u(){$("#for_transformation_files").empty(),$("#transformed_files").empty()}function v(){$(".active").removeClass("active"),$(".step").slideUp(100),n()}function w(){var h,a=$("#organization").val(),f=($("#file_type").val(),$("#transformation_type").val(),$("#mapping_type").val(),$("#google_link").val(),$("#specific_mapping_google_step").val()),g=$("#specific_trans_xquery").val();"xml_ead"===$("#file_type").val()?(h="http://localhost:8080/rest/process",$.get(h,function(a){var b=a,c=0;$.each(b.split("|"),function(a,b){var d=b.split("="),e=d[0],f=d[1],g=e.substring(e.lastIndexOf("html")+5),h=e+".html";$("#errors_table").append('<tr><td><span class="getContent" address="'+h+'">'+g+"</span></td><td>"+f+"</td></tr>"),c++}),$("#tableErrors").DataTable(),$("#transformed_files").append(c),$("#step5").slideUp(300),$("#step6").slideDown(300),$(".active").removeClass("active"),$("#label_step_6").addClass("active"),q(),$(".getContent").on("click",function(){var a=$(this).attr("address"),b={async:!0,crossDomain:!0,url:"http://localhost:8080/rest//htmlReport?path="+a,method:"GET",headers:{"cache-control":"no-cache"}};$.ajax(b).done(function(a){var b=fileName.substring(fileName.lastIndexOf("\\")+1);b=b.replace(".html",""),$("#step6").append('<div class="responseHolder"><h2 style="margin-top: -33px;">'+b+'</h2><span class="closeResponse">X</span>'+a+"</div>");var c=$(".responseHolder").height(),d=c+200;d+="px",$("#page").css("min-height",d),$(window).scrollTop("0"),$(".closeResponse").on("click",function(){$(".responseHolder").remove(),$("#page").css("min-height","500px")})})})})):"generic"===$("#mapping_type").val()&&""!=f?(h="http://localhost:8080/rest/process?mapping="+f,$.get(h,function(a){var b=a,c=0;$.each(b.split("|"),function(a,b){var d=b.split("="),e=d[0],f=d[1],g=e.substring(e.lastIndexOf("html")+5),h=e+".html";$("#errors_table").append('<tr><td><span class="getContent" address="'+h+'">'+g+"</span></td><td>"+f+"</td></tr>"),c++}),$("#tableErrors").DataTable(),$("#transformed_files").append(c),$("#step5").slideUp(300),$("#step6").slideDown(300),$(".active").removeClass("active"),$("#label_step_6").addClass("active"),q(),$(".getContent").on("click",function(){var a=$(this).attr("address"),b={async:!0,crossDomain:!0,url:"http://localhost:8080/rest//htmlReport?path="+a,method:"GET",headers:{"cache-control":"no-cache"}};$.ajax(b).done(function(a){var b=fileName.substring(fileName.lastIndexOf("\\")+1);b=b.replace(".html",""),$("#step6").append('<div class="responseHolder"><h2 style="margin-top: -33px;">'+b+'</h2><span class="closeResponse">X</span>'+a+"</div>");var c=$(".responseHolder").height(),d=c+200;d+="px",$("#page").css("min-height",d),$(window).scrollTop("0"),$(".closeResponse").on("click",function(){$(".responseHolder").remove(),$("#page").css("min-height","500px")})})})})):"generic"===$("#mapping_type").val()&&""===f?(h="http://localhost:8080/rest/process?organisation="+a,$.get(h,function(a){var b=a,c=0;$.each(b.split("|"),function(a,b){var d=b.split("="),e=d[0],f=d[1],g=e.substring(e.lastIndexOf("html")+5),h=e+".html";$("#errors_table").append('<tr><td><span class="getContent" address="'+h+'">'+g+"</span></td><td>"+f+"</td></tr>"),c++}),$("#tableErrors").DataTable(),$("#transformed_files").append(c),$("#step5").slideUp(300),$("#step6").slideDown(300),$(".active").removeClass("active"),$("#label_step_6").addClass("active"),q(),$(".getContent").on("click",function(){var a=$(this).attr("address"),b=$(this).attr("address"),c={async:!0,crossDomain:!0,url:"http://localhost:8080/rest//htmlReport?path="+a,method:"GET",headers:{"cache-control":"no-cache"}};$.ajax(c).done(function(a){var c=b.substring(b.lastIndexOf("\\")+1);c=c.replace(".html",""),$("#step6").append('<div class="responseHolder"><h2 style="margin-top: -33px;">'+c+'</h2><span class="closeResponse">X</span>'+a+"</div>");var d=$(".responseHolder").height(),e=d+200;e+="px",$("#page").css("min-height",e),$(window).scrollTop("0"),$(".closeResponse").on("click",function(){$(".responseHolder").remove(),$("#page").css("min-height","500px")})})})})):"specific"===$("#mapping_type").val()&&(h="http://localhost:8080/rest/process?xquery="+g,$.get(h,function(a){var b=a,c=0;$.each(b.split("|"),function(a,b){var d=b.split("="),e=d[0],f=d[1],g=e.substring(e.lastIndexOf("html")+5),h=e+".html";$("#errors_table").append('<tr><td><span class="getContent" address="'+h+'">'+g+"</span></td><td>"+f+"</td></tr>"),c++}),$("#tableErrors").DataTable(),$("#transformed_files").append(c),$("#step5").slideUp(300),$("#step6").slideDown(300),$(".active").removeClass("active"),$("#label_step_6").addClass("active"),q(),$(".getContent").on("click",function(){var a=$(this).attr("address"),b={async:!0,crossDomain:!0,url:"http://localhost:8080/rest//htmlReport?path="+a,method:"GET",headers:{"cache-control":"no-cache"}};$.ajax(b).done(function(a){var b=fileName.substring(fileName.lastIndexOf("\\")+1);b=b.replace(".html",""),$("#step6").append('<div class="responseHolder"><h2 style="margin-top: -33px;">'+b+'</h2><span class="closeResponse">X</span>'+a+"</div>");var c=$(".responseHolder").height(),d=c+200;d+="px",$("#page").css("min-height",d),$(window).scrollTop("0"),$(".closeResponse").on("click",function(){$(".responseHolder").remove(),$("#page").css("min-height","500px")})})})}))}function x(){navigator.onLine?$.get(i,function(a){var b=a;$.each(b.split("|"),function(a,b){$(d).append('<option value="'+b+'">'+b+"</option>")}),$(d).append('<option value="no_organization">Other</option>')}):$(d).append('<option value="no_organization">Other</option>')}var a=$(".submit"),b=$(".loader"),c=$(".loader_img"),d=$("#organization"),e=$("#file_type"),f=$("#transformation_type"),g=$("#mapping_type"),i=($("#mapping_location_btn_google"),"http://localhost:8080/rest/list-organisations"),j="http://localhost:8080/rest/list-mapping-dir-contents",l="http://localhost:8080/rest/list-input-dir-contents",m="http://localhost:8080/rest/list-xquery-dir-contents";$(d).on("change",function(){var a=this.value;""!=a&&o()}),$(e).on("change",function(){var a=this.value;""!=a&&o()}),$(f).on("change",function(){var a=this.value;""!=a&&o()}),$(g).on("change",function(){var a=this.value;""!=a&&o()}),$("#specific_mapping_google_step").on("change",function(){var a=$("#specific_mapping_google_step").val();""!=a?($("#view_google").slideUp(300),$("#iframe_holder").slideUp(300)):($("#view_google").slideDown(300),$("#iframe_holder").slideDown(300))}),x(),n(),$(".previous_step").click(function(a){var b=a.target.id;"previous_step2"===b?(v(),$("#label_step_1").addClass("active"),$("#step1").slideDown(300)):"previous_step2_1"===b?(v(),$("#label_step_1").addClass("active"),$("#step1").slideDown(300)):"previous_step3"===b?(v(),$("#label_step_2").addClass("active"),$("#step2").slideDown(300)):"previous_step4"===b?(v(),$("#label_step_3").addClass("active"),$("#step3").slideDown(300)):"previous_step4_1"===b?(v(),$("#label_step_3").addClass("active"),$("#step3").slideDown(300)):"previous_step5"===b&&(v(),$("#label_step_4").addClass("active"),$("#step4").slideDown(300))}),$(".submit_step").click(function(a){var b=a.target.id;if("submit_step1"===b){$("#step1").slideUp(300),$("#step2").slideDown(300),$(".active").removeClass("active"),$("#label_step_2").addClass("active"),$("#organization_name").empty();var c=$("#organization").val(),d="Organization: "+c;$("#organization_name").append(d),n()}else if("submit_step2"===b)$("#step2").slideUp(300),"xml_ead"===$("#file_type").val()?($("#step2_1").slideDown(300),n()):($("#step3").slideDown(300),$(".active").removeClass("active"),$("#label_step_3").addClass("active"),n()),n();else if("submit_step2_1"===b)$("#step2_1").slideUp(300),"ead_2"===$("#transformation_type").val()?($("#step5").slideDown(300),$(".active").removeClass("active"),$("#label_step_5").addClass("active"),r()):"mapping"===$("#transformation_type").val()&&($("#step3").slideDown(300),$(".active").removeClass("active"),$("#label_step_3").addClass("active")),n();else if("submit_step3"===b){if("generic"===$("#mapping_type").val()){if(navigator.onLine){if("no_organization"!=$("#organization").val()){var e="http://localhost:8080/rest/mapping-sheet-ID?organisation="+$("#organization").val();$.get(e,function(a){var b="https://docs.google.com/spreadsheets/d/"+a+"/edit?usp=sharing";$("#view_google").attr("href",b),$("#google_link").val(b),$("#google_link").attr("value",b),$("#google-iframe").attr("src",b),$("#google-iframe").show(),$("#view_google").show()})}else $("#google-iframe").hide(),$("#view_google").hide();$("#step3").slideUp(300),$("#step4").slideDown(300)}else $("#step3").slideUp(300),$("#step4").slideDown(300),$("#view_google").hide(),$("#iframe_holder").hide();$.get(j,function(a){var b=a;$.each(b.split("|"),function(a,b){$("#specific_mapping_google_step").append('<option value="'+b+'">'+b+"</option>")})})}else"specific"===$("#mapping_type").val()&&($("#step3").slideUp(300),$("#step4_1").slideDown(300),$.get(m,function(a){var b=a;$.each(b.split("|"),function(a,b){$("#specific_trans_xquery").append('<option value="'+b+'">'+b+"</option>")})}));$(".active").removeClass("active"),$("#label_step_4").addClass("active"),a.preventDefault()}else if("submit_step4"===b)$("#step4").slideUp(300),$("#step5").slideDown(300),$(".active").removeClass("active"),$("#label_step_5").addClass("active"),r(),n();else if("submit_step4_1"===b)$("#step4_1").slideUp(300),$("#step5").slideDown(300),$(".active").removeClass("active"),$("#label_step_5").addClass("active"),n(),r();else if("submit_step5"===b){p(),w();var f=0;$.get(l,function(a){var b=a;$.each(b.split("|"),function(a,b){f++}),$("#for_transformation_files").append(f)})}else{if("start_new"===b)return $("#step6").slideUp(300),$("#step2").slideDown(300),$(".active").removeClass("active"),$("#label_step_2").addClass("active"),$("#file_type").val(""),$("#transformation_type").val(""),$("#mapping_type").val(""),$("#iframe_holder").show(),$("#specific_mapping_google_step").val(""),$("#specific_trans_xquery").val(""),t(),u(),!1;if("repeat"===b)return $("#step6").slideUp(300),$("#step5").slideDown(300),$(".active").removeClass("active"),$("#label_step_5").addClass("active"),u(),!1}}),$(".step_label").click(function(a){var b=a.target.id;"label_step_1"===b?(v(),$("#step1").slideDown(300),$(this).addClass("active")):"label_step_2"===b?""!=$("#organization").val()?(v(),$(this).addClass("active"),$("#step2").slideDown(300)):(v(),$("#step1").slideDown(300),$("#label_step_1").addClass("active")):"label_step_3"===b?""!=$("#file_type").val()&&""!=$("#organization").val()?(v(),$(this).addClass("active"),$("#step3").slideDown(300)):""!=$("#organization").val()?(v(),$("#step2").slideDown(300),$("#label_step_2").addClass("active")):(v(),$("#step1").slideDown(300),$("#label_step_1").addClass("active")):"label_step_4"===b?""!=$("#file_type").val()&&""!=$("#organization").val()&&""!=$("#mapping_type").val()?(v(),$(this).addClass("active"),$("#step4").slideDown(300)):""!=$("#organization").val()?(v(),$("#step2").slideDown(300),$("#label_step_2").addClass("active")):(v(),$("#step1").slideDown(300),$("#label_step_1").addClass("active")):"label_step_5"===b?""!=$("#file_type").val()&&""!=$("#organization").val()&&""!=$("#mapping_type").val()?(v(),$(this).addClass("active"),$("#step5").slideDown(300)):""!=$("#organization").val()?(v(),$("#step2").slideDown(300),$("#label_step_2").addClass("active")):(v(),$("#step1").slideDown(300),$("#label_step_1").addClass("active")):"label_step_6"===b&&(""!=$("#file_type").val()&&""!=$("#organization").val()&&""!=$("#mapping_type").val()?(v(),$(this).addClass("active"),$("#step6").slideDown(300)):""!=$("#organization").val()?(v(),$("#step2").slideDown(300),$("#label_step_2").addClass("active")):(v(),$("#step1").slideDown(300),$("#label_step_1").addClass("active")))})});